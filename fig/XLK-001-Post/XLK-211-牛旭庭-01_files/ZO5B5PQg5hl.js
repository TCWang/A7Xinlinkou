if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }

__d("MAnimatedScroll",["MAnimator","MViewport","Vector","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";var h=null,i=500;function j(a){a&&c("clearTimeout")(a);return null}function k(a,b,e){h=j(h);b=b.duration===null||b.duration===void 0?i:b.duration;var f=d("MViewport").getScrollTop();if(f===a)return;var g=f;c("MAnimator").play(f,a,b,function(b){var e=c("MAnimator").easeInOutCubic((b-g)/(f-a));e=Math.round((b-g)*e+g);g=b;d("MViewport").scrollToY(e)});e&&(h=c("setTimeoutAcrossTransitions")(e,b))}function a(a,b){k(0,a,b)}function b(a,b,d,e){k(c("Vector").getPos(a).y-b,d,e)}g.scrollToOffset=k;g.scrollToTop=a;g.scrollToNode=b}),98);
__d("MStoriesProductionInfo",[],(function(a,b,c,d,e,f){"use strict";a={_uploadStatus:null,_uri:null,_rotate:0,setUploadStatus:function(a){this._uploadStatus=a},getUploadStatus:function(){return this._uploadStatus},setChosenImage:function(a){var b=a.URI;a=a.rotate;this._uri=b;this._rotate=a},getChosenImage:function(){return{URI:this._uri,rotate:this._rotate}}};e.exports=a}),null);
__d("XMStoriesProductionPreviewController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/stories/preview/",{session_key:{type:"String"}})}),null);
__d("MStoriesCreation",["fbt","Bootloader","MPageController","MStoriesProductionInfo","MStoriesUploadStatus","MStoriesUtils","Promise","UserAgent","XMStoriesProductionPreviewController","nullthrows","promiseDone","uuid"],(function(a,b,c,d,e,f,g,h){function i(a){return new(b("Promise"))(function(b){var c=new FileReader();c.onload=function(a){return b(a.target.result)};c.readAsDataURL(a)})}a=function(){function a(b){var e=this;this.$3="";this.$5=function(a){a=d("MStoriesProductionInfo").getUploadStatus();if(a===c("MStoriesUploadStatus").UPLOADING){c("Bootloader").loadModules(["MStoriesToast"],function(a){a.showDefaultToast(h._(/*FBT_CALL*/"\u6b63\u5728\u4e0a\u50b3\u9650\u6642\u52d5\u614b"/*FBT_CALL*/))},"MStoriesCreation");return}e.$3=c("uuid")();d("MStoriesProductionInfo").setUploadStatus(c("MStoriesUploadStatus").IDLE);e.$2.click()};var f=0,g=c("UserAgent").isBrowser("Firefox")&&c("UserAgent").isPlatform("Android");this.$1=b.item;this.$2=b.input;a.$4=this;this.$1.addEventListener("click",this.$5,!0);this.$2&&this.$2.addEventListener("change",function(a){a=a.target.files;var b=null;for(var h=0;h<a.length;h++)if(a[h].type.match(/^image\//)){b=a[h];break}if(b!==null){e.$6();var j=function(a){f=a;if(g)c("promiseDone")(i(c("nullthrows")(b)),function(a){a=a;d("MStoriesProductionInfo").setChosenImage({URI:a,rotate:f});e.$7()});else{a=URL.createObjectURL(c("nullthrows")(b));d("MStoriesProductionInfo").setChosenImage({URI:a,rotate:f});e.$7()}};d("MStoriesUtils").displaysExifRotationCorrectly()?j(0):c("Bootloader").loadModules(["ImageExifRotation"],function(a){a.getRotation(b,j)},"MStoriesCreation")}})}var b=a.prototype;b.$6=function(){d("MStoriesUtils").setExitUri(window.location.href,!0)};b.$7=function(){var a=c("XMStoriesProductionPreviewController").getURIBuilder().setString("session_key",this.$3).getURI();d("MPageController").load(a);this.$3=""};return a}();a.$4=null;g["default"]=a}),98);
__d("MStoriesProductionTrayUtils",["cx","CSS","MFBStoriesGatingConfig","MStoriesDOMUtils","MStoriesProductionInfo","MStoriesUploadStatus"],(function(a,b,c,d,e,f,g){"use strict";var h={getAnimationPog:function(){var a=document.getElementById("m-stories-owner-bucket-pog");return a?a:document.getElementById("m-stories-add-item-pog")},getUploadingClass:function(){var a=b("MFBStoriesGatingConfig").trayType;return a==="nine_by_sixteen"?"loading":"_1zpf"},updateProductionPog:function(){var a=b("MStoriesProductionInfo").getUploadStatus();if(a===b("MStoriesUploadStatus").UPLOADING){var c=h.getAnimationPog(),d=document.getElementById("m-stories-add-item-pog"),e=document.getElementById("m-stories-add-item"),f=document.getElementById("m-stories-owner-bucket-pog"),g=h.getUploadingClass();c&&(b("CSS").addClass(c,g),c.id==="m-stories-owner-bucket-pog"?(d&&b("CSS").removeClass(d,g),e&&b("CSS").addClass(e,"disable")):(f&&b("CSS").removeClass(f,g),e&&b("CSS").removeClass(e,"disable")))}c=b("MFBStoriesGatingConfig").trayType;if(c!=="circular"){d=document.getElementById("m-stories-owner-bucket");if(d){f=d.getAttribute("data-is-optimistic-item")!=null;g=a===b("MStoriesUploadStatus").UPLOADING||a===b("MStoriesUploadStatus").FAILED;f&&(g?b("CSS").removeClass(d,"hidden"):b("CSS").addClass(d,"hidden"))}this._updateProductionItemText()}this._updateErrorState()},_updateProductionItemText:function(){var a=document.getElementById("m-stories-owner-bucket");if(!a)return;var c=b("MStoriesDOMUtils").find(a,"div","m-stories-rectangular-item-title");a=b("MStoriesDOMUtils").find(a,"div","m-stories-rectangular-item-adding-story-title");if(c&&a){var d=b("MStoriesProductionInfo").getUploadStatus();switch(d){case b("MStoriesUploadStatus").UPLOADING:b("CSS").addClass(c,"hidden");b("CSS").removeClass(a,"hidden");break;default:b("CSS").addClass(a,"hidden");b("CSS").removeClass(c,"hidden");break}}},_updateErrorState:function(){var a=b("MStoriesProductionInfo").getUploadStatus(),c=b("MFBStoriesGatingConfig").trayType;switch(c){case"fblite_with_profile_pog":c=document.getElementById("m-stories-owner-bucket");if(c!=null){var d=b("MStoriesDOMUtils").find(c,"div","m-stories-rectangular-item-count");c=b("MStoriesDOMUtils").find(c,"div","m-stories-rectangular-item-count-error");d&&c&&(a===b("MStoriesUploadStatus").FAILED?(b("CSS").addClass(d,"hiddenByError"),b("CSS").removeClass(c,"hidden")):(b("CSS").removeClass(d,"hiddenByError"),b("CSS").addClass(c,"hidden")))}break;case"mobile_three_by_one":d=this.getAnimationPog();a===b("MStoriesUploadStatus").FAILED?b("CSS").addClass(d,"_6y1s"):b("CSS").removeClass(d,"_6y1s");break;case"nine_by_sixteen":c=this.getAnimationPog();d=document.getElementById("m-stories-owner-title");a===b("MStoriesUploadStatus").FAILED?(b("CSS").addClass(c,"error"),d&&b("CSS").addClass(d,"error")):(b("CSS").removeClass(c,"error"),d&&b("CSS").removeClass(d,"error"));break;default:c=this.getAnimationPog();c&&(a===b("MStoriesUploadStatus").FAILED?b("CSS").addClass(c,"_4ts1"):b("CSS").removeClass(c,"_4ts1"));break}}};e.exports=h}),null);
__d("MStoriesTrayUIConstants",[],(function(a,b,c,d,e,f){"use strict";a=20;f.REDIRECT_DELAY_IN_MS=a}),66);
__d("MStoriesTrayAsync",["cx","Bootloader","CSS","DOM","MFBStoriesGatingConfig","MFBStoriesOptimisticTrayGatedModule","MPageController","MStoriesDOMUtils","MStoriesGating","MStoriesHideHeaderListener","MStoriesProductionTrayUtils","MStoriesStratcomEvents","MStoriesTrayInfo","MStoriesTrayUIConstants","QuickPerformanceLogger","Run","Stratcom","qpl"],(function(a,b,c,d,e,f,g){var h=b("MFBStoriesOptimisticTrayGatedModule").module,i="m:page:render:cache:complete-with-replays";a={_currentItemLoading:null,_listeners:[],_spinner:null,_feedUnitURIs:[],registerFeedUnitWithUri:function(a){this._feedUnitURIs.push(a.uri),this._init()},updateSpinner:function(a){this._spinner=a.spinner,this._init()},_init:function(){var a=this;if(this._listeners.length>0)return;this._listeners=[b("Stratcom").listen(i,null,function(){if(!b("MStoriesTrayInfo").getTrayNeedsRefresh())return;b("Bootloader").loadModules(["MStoriesTrayUtils"],function(b){b.refreshTray(),b.refreshFeedUnitsWithURIs(a._feedUnitURIs)},"MStoriesTrayAsync")}),b("Stratcom").listen("click","m-stories-tray-archive-link",this._openArchive),b("Stratcom").listen("click","m-stories-tray-pog-container",function(b){a._openPOG(b)}),b("Stratcom").listen("keypress","m-stories-tray-pog-container",function(b){var c=b.getSpecialKey();(c==="return"||c==="space")&&(b.prevent(),a._openPOG(b))}),b("Stratcom").listen(b("MStoriesStratcomEvents").UPLOAD_SUCCESS,null,function(a){a=a.getData()||{};h&&h.handleUploadSuccess(a.newThreadID,a.optimisticThreadID)})];b("MStoriesHideHeaderListener").setup();h&&h.initializeOnTrayLoad();b("MStoriesProductionTrayUtils").updateProductionPog();b("Run").onLeave(function(){a._destroy()})},_openArchive:function(a){a=a.getNode("m-stories-tray-archive-link");if(a!=null){var c=a.getAttribute("data-href");c&&window.setTimeout(function(){b("MPageController").load(c,{hideLoadingIndicator:!1})})}},_openPOG:function(a){var c=this,d=a.getNode("m-stories-tray-pog-container");if(this._currentItemLoading){if(this._currentItemLoading===d)return;this._setLoadingStateHidden(this._currentItemLoading,!0)}if(!d)return;d.id==="m-stories-owner-bucket"?b("Bootloader").loadModules(["MStoriesProductionTrayAsync"],function(a){if(!d)return;if(a.handleFailedAddToStoryPogSelected())return;c._openViewer(d)},"MStoriesTrayAsync"):this._openViewer(d)},_setLoadingStateHidden:function(a,c){var d=b("MFBStoriesGatingConfig").trayType,e=c?b("CSS").removeClass:b("CSS").addClass;switch(d){case"circular":e(a,"loading");break;case"fblite_with_profile_pog":e(a,"_6pvo");break;case"nine_by_sixteen":case"mobile_three_by_one":a=b("MStoriesDOMUtils").find(a,"div","m-stories-tray-pog");if(a){if(c&&a.id==="m-stories-owner-bucket-pog")return;d==="nine_by_sixteen"?e(a,"loading"):e(a,"_1zpf")}break}},_openViewer:function(a){this._currentItemLoading=a;var c=b("MFBStoriesGatingConfig").trayType;c=c!=="circular";b("QuickPerformanceLogger").markerEnd(b("qpl")._(13238313,"2969"),4);b("QuickPerformanceLogger").markerStart(b("qpl")._(13238313,"2969"));if(!c){c=b("MStoriesDOMUtils").find(a,"i","m-stories-tray-pog-picture");c!=null&&b("DOM").insertAfter(c,this._spinner)}var d=a.getAttribute("data-href");b("MStoriesGating").shouldShowOptimisticPreviews()&&a.id==="m-stories-owner-bucket"&&h&&(d=h.getURI(a));d&&(this._setLoadingStateHidden(a,!1),window.setTimeout(function(){b("MPageController").load(d,{hideLoadingIndicator:!0});var a=b("Stratcom").listen("m:page:iui:response:complete",null,function(b){b=b.getData()||{};b=b.path;if(b==null||!b.includes("stories/view_tray"))return;a.remove()})},b("MStoriesTrayUIConstants").REDIRECT_DELAY_IN_MS))},_destroy:function(){var a=b("MStoriesProductionTrayUtils").getAnimationPog();a&&b("CSS").removeClass(a,b("MStoriesProductionTrayUtils").getUploadingClass());this._listeners.forEach(function(a){return a.remove()});this._listeners=[]}};e.exports=a}),null);
__d("MFeedRefresh",["Event","MAnimatedScroll","MHome","MPageController","MViewport","Stratcom","SubscriptionsHandler","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";var h="/home.php",i=!1,j=!1,k=new(c("SubscriptionsHandler"))(),l=null,m=null,n=0,o=!1,p=500;function q(a){d("MViewport").scrollToTop(),d("MPageController").forceLoad(a)}function r(a){var b=h,c=!1;a&&(a.feedPath!==null&&a.feedPath!==void 0&&(b=a.feedPath),c=!!a.animate);if(c&&a){c=a.animationDuration===null||a.animationDuration===void 0?p:a.animationDuration;d("MAnimatedScroll").scrollToTop({duration:c},function(){q(b)})}else q(b)}function s(){n=0,l&&(c("clearTimeout")(l),l=null)}function t(){s(),j&&(k.release(),k.engage())}function u(a){if(!d("MHome").isHome())return!1;var b=!0;if(a&&n&&m!==null){a=Date.now()-n;b=a>=m}if(!b)return!1;t();r();return!0}function v(){s(),n=Date.now(),l=c("setTimeoutAcrossTransitions")(function(){u(!1)},m)}function w(){var a=u(!0);a||v()}function x(){t();var a=d("MHome").isHome();if(!a)return;v();j&&(k.addSubscriptions(c("Event").listen(document,"touchstart",w,!0)),o&&k.addSubscriptions(c("Event").listen(document,"mousedown",w,!0)))}function y(a,b){b===void 0&&(b=!1);if(a<=0)return;m=a*60*1e3;j=b;c("Stratcom").listen("history:change",null,x);x()}function a(a){if(i)return;y(a.intervalMinutes,a.resetOnTouch);i=!0}g.reloadFeed=r;g.reloadFeedIfNeeded=u;g.init=a}),98);
__d("Time",[],(function(a,b,c,d,e,f){a={getGMTOffset:function(a){var b=new Date(),c=b.getTimezoneOffset()/30;b=b.getTime()/1e3;a=Math.round((a-b)/1800);b=Math.round(c+a)%48;b>24?b-=Math.ceil(b/48)*48:b<-28&&(b+=Math.ceil(b/-48)*48);return b*30}};e.exports=a}),null);
__d("XPageFollowMutatorController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/page/follow_mutator/",{privacy_mutation_token:{type:"String"},page_id:{type:"Int",required:!0},status:{type:"Bool",defaultValue:!1},location:{type:"Enum",required:!0,enumType:0}})}),null);
__d("MFollowSwapButton",["DOM","Event","MRequest","XPageFollowMutatorController"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,d,e,f){var g=this;f===void 0&&(f=0);this.$5=0;this.$1=a;this.$2=b;this.$3=d;this.$4=e;this.$5=f;c("Event").listen(a,"click",function(){return g.swap()});c("Event").listen(b,"click",function(){return g.swap()})}var b=a.prototype;b.swap=function(){this.$4=!this.$4;var a=c("XPageFollowMutatorController").getURIBuilder().setInt("page_id",this.$3).setBool("status",this.$4).setEnum("location",this.$5).getURI();a=new(c("MRequest"))(a).setMethod("POST");a.send();this.$4?(d("DOM").insertAfter(this.$1,this.$2),d("DOM").remove(this.$1)):(d("DOM").insertAfter(this.$2,this.$1),d("DOM").remove(this.$2))};return a}();g["default"]=a}),98);
__d("TimezoneAutoset",["MRequest","Time"],(function(a,b,c,d,e,f){var g;a=function(a){if(g)return;g=!0;if(!a.time||a.offset===void 0)return;var c=-b("Time").getGMTOffset(a.time);(a.forceUpdate||c!=a.offset)&&new(b("MRequest"))(a.uri).setMethod("POST").setData({offset:c,is_forced:a.forceUpdate}).send()};f.main=a}),null);
__d("MVideoHomeAutoAdvanceManager",["DataStore","MAnimatedScroll","MFullScreen","MViewport","Stratcom","Vector","VideoHomeTypedLogger"],(function(a,b,c,d,e,f,g){"use strict";var h=70,i=new Map();c("Stratcom").listen("m:video:player:ended",null,function(a){if(c("MFullScreen").isFullScreen())return;a=a.getData().videoElement;a=d("DataStore").get(a,"feedPosition");if(a!=null&&typeof a==="number"){var b=parseInt(a,10)+1;if(i.has(a)&&i.has(b)){a=i.get(a);b=i.get(b);a instanceof HTMLElement&&b instanceof HTMLElement&&k(a,b)}}});function j(a,b){b=b;a=a;var c=0,d=5;while(a instanceof HTMLElement&&b===0&&c<d){var e=window.getComputedStyle(a),f=e.display,g=e.position;e=e.visibility;a.style.position="absolute";a.style.visibility="hidden";a.style.display="block";b=a.offsetHeight;a.style.display=f;a.style.position=g;a.style.visibility=e;a=a.parentElement;c++}return b}function k(a,b){var e=c("MViewport").getScrollTop(),f=c("Vector").getPos(b);f=f.y-h;var g=b.getBoundingClientRect().top;g=e+g-h;var i=a.offsetHeight;i===0&&(i=j(a,i));a=e+i;f<=e?a>e?(new(c("VideoHomeTypedLogger"))().setEvent("msite_feed_alternative_height_auto_advance").log(),d("MAnimatedScroll").scrollToOffset(a,{})):g>e?(new(c("VideoHomeTypedLogger"))().setEvent("msite_feed_alternative_rect_auto_advance").log(),d("MAnimatedScroll").scrollToOffset(g,{})):new(c("VideoHomeTypedLogger"))().setEvent("msite_feed_failed_auto_advance").log():(new(c("VideoHomeTypedLogger"))().setEvent("msite_feed_auto_advance").log(),d("MAnimatedScroll").scrollToNode(b,h,{}))}a={registerUnit:function(a,b){i.set(b,a)}};b=a;g["default"]=b}),98);
__d("MarketplaceReplaceState",[],(function(a,b,c,d,e,f){function a(a){window.history.replaceState({},"",a)}f.replaceState=a}),66);
__d("fbjs/lib/ExecutionEnvironment",["ExecutionEnvironment"],(function(a,b,c,d,e,f){"use strict";e.exports=b("ExecutionEnvironment")}),null);
__d("PlatformWindowDialogCloser",[],(function(a,b,c,d,e,f){"use strict";function a(){window.close()}f.close=a}),66);