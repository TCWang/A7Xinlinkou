window.addEventListener("load",(function(){const links=document.querySelectorAll(".mini-cart-info"),minicarts=document.querySelectorAll(".dmc-container"),counts=document.querySelectorAll("span.divi_mini_cart_count"),overlays=document.querySelectorAll("span.dmc-overlay"),options=divi_mini_cart_options;let openCart=!1,hoverColision=!1,clicked=!1,hovered=!1,animationCounter;function iconClick(e){e.stopPropagation(),e.preventDefault(),clicked=!0,hoverColision||hovered?clearTimeout(animationCounter):openCart?(openCart=!1,closeMinicarts()):(clearTimeout(animationCounter),openCart=!0,openMinicarts())}function iconHover(e){clearTimeout(animationCounter),openCart||(hovered=!0,hoverColision=!0,openCart=!0,openMinicarts(),setTimeout((function(){hoverColision=!1}),100))}function iconHoverOver(e){clicked||(animationCounter=setTimeout((function(){openCart=!1,closeMinicarts()}),parseInt(options.hover_close)))}function openMinicarts(){minicarts.forEach(item=>{if(display(item,"flex"),setTimeout((function(){item.classList.add("active")}),33),!options.fixed)if(window.innerWidth<600){const elemRects=item.parentElement.getBoundingClientRect();item.style.right=`${-1*(window.innerWidth-elemRects.right)}px`}else item.style.right=""}),overlays.forEach((function(item){display(item,"block"),setTimeout((function(){item.classList.add("active")}),33)}))}function closeMinicarts(){minicarts.forEach(item=>{item.classList.remove("active")}),overlays.forEach((function(item){item.classList.remove("active")})),clicked=!1,hovered=!1,animationCounter=setTimeout((function(){minicarts.forEach(item=>{display(item,"none")}),overlays.forEach((function(item){display(item,"none")}))}),parseInt(options.animation_duration))}function minicartHover(){clearTimeout(animationCounter)}function minicartHoverOver(){clicked||(animationCounter=setTimeout((function(){openCart=!1,closeMinicarts()}),parseInt(options.hover_close)))}function removeCartItem(e){if(!e.target.classList.contains("dmc-remove-link"))return;e.preventDefault();const params=new URLSearchParams({action:"remove_cart_item",cart_item_key:e.target.dataset.cart_item_key,nonce:divi_mini_cart_options.nonce});ajaxMinicart(params)}function display(item,value){item.style.display=value}function refreshMinicarts(){options.ajax_show&&(openCart||(hovered=!1,clicked=!1,openCart=!0,clearTimeout(animationCounter),openMinicarts()));const params=new URLSearchParams({action:"remove_cart_item",refresh:!0,nonce:divi_mini_cart_options.nonce});ajaxMinicart(params)}function ajaxMinicart(params){minicarts.forEach(item=>item.classList.add("loading")),fetch(divi_mini_cart_options.ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:params}).then((function(response){if(response.ok)return response.json();minicarts.forEach(item=>{item.classList.remove("loading")})})).then((function(data){counts.forEach(item=>{item.innerHTML=data.cart_count}),minicarts.forEach(item=>{item.innerHTML=data.cart_content,item.classList.remove("loading")})})).catch(error=>{minicarts.forEach(item=>{item.classList.remove("loading"),console.log(error)})})}jQuery(document.body).on("added_to_cart",refreshMinicarts),links.forEach(item=>{jQuery(item).off("click"),item.addEventListener("click",iconClick),options.hover&&(item.addEventListener("mouseenter",iconHover),parseInt(options.hover_close)&&item.addEventListener("mouseleave",iconHoverOver))}),document.addEventListener("click",(function(e){e.target.closest(".dmc-container")||(clearTimeout(animationCounter),openCart=!1,closeMinicarts())})),minicarts.forEach(item=>{options.fixed?item.classList.add("fixed-"+options.fixed_position):item.classList.add("normal"),item.style.transition=`all ${parseInt(options.animation_duration)}ms ease`,options.fix_buttons&&item.classList.add("fixed-buttons"),item.addEventListener("click",removeCartItem),parseInt(options.hover_close)&&(item.addEventListener("mouseenter",minicartHover),item.addEventListener("mouseleave",minicartHoverOver))}),overlays.forEach((function(item){item.style.backgroundColor=options.overlay_color,item.style.transition=`all ${parseInt(options.animation_duration)/2}ms ease`}))}));